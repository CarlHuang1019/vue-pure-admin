{"version":3,"file":"update.vue_vue_type_script_setup_true_lang.js","sources":["../../../src/views/login/components/update.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { useI18n } from \"vue-i18n\";\nimport { ref, reactive } from \"vue\";\nimport Motion from \"../utils/motion\";\nimport { message } from \"@/utils/message\";\nimport { updateRules } from \"../utils/rule\";\nimport type { FormInstance } from \"element-plus\";\nimport { useVerifyCode } from \"../utils/verifyCode\";\nimport { $t, transformI18n } from \"@/plugins/i18n\";\nimport { useUserStoreHook } from \"@/store/modules/user\";\nimport { useRenderIcon } from \"@/components/ReIcon/src/hooks\";\nimport Lock from \"@iconify-icons/ri/lock-fill\";\nimport Iphone from \"@iconify-icons/ep/iphone\";\n\nconst { t } = useI18n();\nconst loading = ref(false);\nconst ruleForm = reactive({\n  phone: \"\",\n  verifyCode: \"\",\n  password: \"\",\n  repeatPassword: \"\"\n});\nconst ruleFormRef = ref<FormInstance>();\nconst { isDisabled, text } = useVerifyCode();\nconst repeatPasswordRule = [\n  {\n    validator: (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(transformI18n($t(\"login.passwordSureReg\"))));\n      } else if (ruleForm.password !== value) {\n        callback(new Error(transformI18n($t(\"login.passwordDifferentReg\"))));\n      } else {\n        callback();\n      }\n    },\n    trigger: \"blur\"\n  }\n];\n\nconst onUpdate = async (formEl: FormInstance | undefined) => {\n  loading.value = true;\n  if (!formEl) return;\n  await formEl.validate((valid, fields) => {\n    if (valid) {\n      // 模拟请求，需根据实际开发进行修改\n      setTimeout(() => {\n        message(transformI18n($t(\"login.passwordUpdateReg\")), {\n          type: \"success\"\n        });\n        loading.value = false;\n      }, 2000);\n    } else {\n      loading.value = false;\n      return fields;\n    }\n  });\n};\n\nfunction onBack() {\n  useVerifyCode().end();\n  useUserStoreHook().SET_CURRENTPAGE(0);\n}\n</script>\n\n<template>\n  <el-form\n    ref=\"ruleFormRef\"\n    :model=\"ruleForm\"\n    :rules=\"updateRules\"\n    size=\"large\"\n  >\n    <Motion>\n      <el-form-item prop=\"phone\">\n        <el-input\n          clearable\n          v-model=\"ruleForm.phone\"\n          :placeholder=\"t('login.phone')\"\n          :prefix-icon=\"useRenderIcon(Iphone)\"\n        />\n      </el-form-item>\n    </Motion>\n\n    <Motion :delay=\"100\">\n      <el-form-item prop=\"verifyCode\">\n        <div class=\"w-full flex justify-between\">\n          <el-input\n            clearable\n            v-model=\"ruleForm.verifyCode\"\n            :placeholder=\"t('login.smsVerifyCode')\"\n            :prefix-icon=\"useRenderIcon('ri:shield-keyhole-line')\"\n          />\n          <el-button\n            :disabled=\"isDisabled\"\n            class=\"ml-2\"\n            @click=\"useVerifyCode().start(ruleFormRef, 'phone')\"\n          >\n            {{\n              text.length > 0\n                ? text + t(\"login.info\")\n                : t(\"login.getVerifyCode\")\n            }}\n          </el-button>\n        </div>\n      </el-form-item>\n    </Motion>\n\n    <Motion :delay=\"150\">\n      <el-form-item prop=\"password\">\n        <el-input\n          clearable\n          show-password\n          v-model=\"ruleForm.password\"\n          :placeholder=\"t('login.password')\"\n          :prefix-icon=\"useRenderIcon(Lock)\"\n        />\n      </el-form-item>\n    </Motion>\n\n    <Motion :delay=\"200\">\n      <el-form-item :rules=\"repeatPasswordRule\" prop=\"repeatPassword\">\n        <el-input\n          clearable\n          show-password\n          v-model=\"ruleForm.repeatPassword\"\n          :placeholder=\"t('login.sure')\"\n          :prefix-icon=\"useRenderIcon(Lock)\"\n        />\n      </el-form-item>\n    </Motion>\n\n    <Motion :delay=\"250\">\n      <el-form-item>\n        <el-button\n          class=\"w-full\"\n          size=\"default\"\n          type=\"primary\"\n          :loading=\"loading\"\n          @click=\"onUpdate(ruleFormRef)\"\n        >\n          {{ t(\"login.definite\") }}\n        </el-button>\n      </el-form-item>\n    </Motion>\n\n    <Motion :delay=\"300\">\n      <el-form-item>\n        <el-button class=\"w-full\" size=\"default\" @click=\"onBack\">\n          {{ t(\"login.back\") }}\n        </el-button>\n      </el-form-item>\n    </Motion>\n  </el-form>\n</template>\n"],"names":["t","useI18n","loading","ref","ruleForm","reactive","ruleFormRef","isDisabled","text","useVerifyCode","repeatPasswordRule","rule","value","callback","transformI18n","$t","onUpdate","formEl","valid","fields","message","onBack","useUserStoreHook"],"mappings":"4YAcM,KAAA,CAAE,EAAAA,GAAMC,IACRC,EAAUC,EAAI,EAAK,EACnBC,EAAWC,EAAS,CACxB,MAAO,GACP,WAAY,GACZ,SAAU,GACV,eAAgB,EAAA,CACjB,EACKC,EAAcH,IACd,CAAE,WAAAI,EAAY,KAAAC,CAAK,EAAIC,EAAc,EACrCC,EAAqB,CACzB,CACE,UAAW,CAACC,EAAMC,EAAOC,IAAa,CAChCD,IAAU,GACZC,EAAS,IAAI,MAAMC,EAAcC,EAAG,uBAAuB,CAAC,CAAC,CAAC,EACrDX,EAAS,WAAaQ,EAC/BC,EAAS,IAAI,MAAMC,EAAcC,EAAG,4BAA4B,CAAC,CAAC,CAAC,EAE1DF,GAEb,EACA,QAAS,MACX,CAAA,EAGIG,EAAW,MAAOC,GAAqC,CAC3Df,EAAQ,MAAQ,GACXe,GACL,MAAMA,EAAO,SAAS,CAACC,EAAOC,IAAW,CACvC,GAAID,EAEF,WAAW,IAAM,CACfE,EAAQN,EAAcC,EAAG,yBAAyB,CAAC,EAAG,CACpD,KAAM,SAAA,CACP,EACDb,EAAQ,MAAQ,IACf,GAAI,MAEP,QAAAA,EAAQ,MAAQ,GACTiB,CACT,CACD,CAAA,EAGH,SAASE,GAAS,CAChBZ,EAAA,EAAgB,MACCa,EAAA,EAAE,gBAAgB,CAAC,CACtC"}