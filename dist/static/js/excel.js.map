{"version":3,"file":"excel.js","sources":["../../../src/views/able/excel.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { utils, writeFile } from \"xlsx\";\n\ndefineOptions({\n  name: \"Excel\"\n});\n\ninterface DataItem {\n  readonly id: string;\n  [propName: string]: string;\n}\n\ninterface Columns {\n  dataKey: string;\n  key: string;\n  title: string;\n  width?: number;\n  [propName: string]: string | number;\n}\n\nconst generateColumns = (length = 10, prefix = \"column-\", props?: any) =>\n  Array.from({ length }).map((_, columnIndex) => ({\n    ...props,\n    key: `${prefix}${columnIndex}`,\n    dataKey: `${prefix}${columnIndex}`,\n    title: `Column ${columnIndex}`,\n    width: 150\n  }));\n\nconst generateData = (\n  columns: ReturnType<typeof generateColumns>,\n  length = 200,\n  prefix = \"row-\"\n) =>\n  Array.from({ length }).map((_, rowIndex) => {\n    return columns.reduce(\n      (rowData, column, columnIndex) => {\n        rowData[column.dataKey] = `Row ${rowIndex} - Col ${columnIndex}`;\n        return rowData;\n      },\n      {\n        id: `${prefix}${rowIndex}`,\n        parentId: null\n      }\n    );\n  });\n\nconst columns = generateColumns(10);\nconst data = generateData(columns, 1000);\n\nconst exportExcel = () => {\n  const res: string[][] = data.map((item: DataItem) => {\n    const arr = [];\n    columns.forEach((column: Columns) => {\n      arr.push(item[column.dataKey]);\n    });\n    return arr;\n  });\n  const titleList: string[] = [];\n  columns.forEach((column: Columns) => {\n    titleList.push(column.title);\n  });\n  res.unshift(titleList);\n  const workSheet = utils.aoa_to_sheet(res);\n  const workBook = utils.book_new();\n  utils.book_append_sheet(workBook, workSheet, \"数据报表\");\n  writeFile(workBook, \"tableV2.xlsx\");\n};\n</script>\n\n<template>\n  <el-card shadow=\"never\">\n    <template #header>\n      <div class=\"font-medium\">\n        导出Excel（\n        <el-link\n          href=\"https://github.com/SheetJS/sheetjs\"\n          target=\"_blank\"\n          style=\"margin: 0 5px 4px 0; font-size: 16px\"\n        >\n          github地址\n        </el-link>\n        ）\n      </div>\n    </template>\n    <el-button type=\"primary\" @click=\"exportExcel\">导出Excel</el-button>\n    <div class=\"h-[25rem] mt-3\">\n      <el-auto-resizer>\n        <template #default=\"{ height, width }\">\n          <el-table-v2\n            :columns=\"columns\"\n            :data=\"data\"\n            :width=\"width\"\n            :height=\"height\"\n            fixed\n          />\n        </template>\n      </el-auto-resizer>\n    </div>\n  </el-card>\n</template>\n"],"names":["generateColumns","length","prefix","props","_","columnIndex","generateData","columns","rowIndex","rowData","column","data","exportExcel","res","item","arr","titleList","workSheet","utils","workBook","writeFile"],"mappings":"gNAoBA,MAAMA,EAAkB,CAACC,EAAS,GAAIC,EAAS,UAAWC,IACxD,MAAM,KAAK,CAAE,OAAAF,CAAQ,CAAA,EAAE,IAAI,CAACG,EAAGC,KAAiB,CAC9C,GAAGF,EACH,IAAK,GAAGD,CAAM,GAAGG,CAAW,GAC5B,QAAS,GAAGH,CAAM,GAAGG,CAAW,GAChC,MAAO,UAAUA,CAAW,GAC5B,MAAO,GACP,EAAA,EAEEC,EAAe,CACnBC,EACAN,EAAS,IACTC,EAAS,SAET,MAAM,KAAK,CAAE,OAAAD,CAAQ,CAAA,EAAE,IAAI,CAACG,EAAGI,IACtBD,EAAQ,OACb,CAACE,EAASC,EAAQL,KAChBI,EAAQC,EAAO,OAAO,EAAI,OAAOF,CAAQ,UAAUH,CAAW,GACvDI,GAET,CACE,GAAI,GAAGP,CAAM,GAAGM,CAAQ,GACxB,SAAU,IACZ,CAAA,CAEH,EAEGD,EAAUP,EAAgB,EAAE,EAC5BW,EAAOL,EAAaC,EAAS,GAAI,EAEjCK,EAAc,IAAM,CACxB,MAAMC,EAAkBF,EAAK,IAAKG,GAAmB,CACnD,MAAMC,EAAM,CAAA,EACJ,OAAAR,EAAA,QAASG,GAAoB,CACnCK,EAAI,KAAKD,EAAKJ,EAAO,OAAO,CAAC,CAAA,CAC9B,EACMK,CAAA,CACR,EACKC,EAAsB,CAAA,EACpBT,EAAA,QAASG,GAAoB,CACzBM,EAAA,KAAKN,EAAO,KAAK,CAAA,CAC5B,EACDG,EAAI,QAAQG,CAAS,EACf,MAAAC,EAAYC,EAAM,aAAaL,CAAG,EAClCM,EAAWD,EAAM,WACjBA,EAAA,kBAAkBC,EAAUF,EAAW,MAAM,EACnDG,EAAUD,EAAU,cAAc,CAAA"}