{"version":3,"file":"columns9.js","sources":["../../../src/views/pure-table/high/edit/columns.tsx"],"sourcesContent":["import { tableDataEdit } from \"../data\";\nimport { message } from \"@/utils/message\";\nimport { ref, computed, Transition } from \"vue\";\nimport { clone, delay } from \"@pureadmin/utils\";\nimport EditPen from \"@iconify-icons/ep/edit-pen\";\nimport Check from \"@iconify-icons/ep/check\";\n\n// 温馨提示：编辑整行方法雷同，将cellRenderer后面渲染的组件抽出来做对应处理即可\nexport function useColumns() {\n  // 编辑值（可多个）\n  const inputValMap = ref({});\n  // 是否正处于编辑状态（可多个）\n  const editStatus = ref({});\n  // 当前激活的单元格（唯一）\n  const activeIndex = ref(-1);\n  const dataList = ref(clone(tableDataEdit, true));\n\n  const comVal = computed(() => {\n    return index => {\n      return inputValMap.value[index]?.value;\n    };\n  });\n\n  const editing = computed(() => {\n    return index => {\n      return editStatus.value[index]?.editing;\n    };\n  });\n\n  const iconClass = computed(() => {\n    return (index, other = false) => {\n      return [\n        \"cursor-pointer\",\n        \"ml-2\",\n        \"transition\",\n        \"delay-100\",\n        other\n          ? [\"hover:scale-110\", \"hover:text-red-500\"]\n          : editing.value(index) && [\"scale-150\", \"text-red-500\"]\n      ];\n    };\n  });\n\n  const columns: TableColumnList = [\n    {\n      label: \"ID（可编辑）\",\n      prop: \"id\",\n      // class=\"flex-bc\" flex-bc 代表 flex justify-between items-center 具体看 src/style/tailwind.css 文件\n      cellRenderer: ({ row, index }) => (\n        <div\n          class=\"flex-bc w-full h-[32px]\"\n          onMouseenter={() => (activeIndex.value = index)}\n          onMouseleave={() => onMouseleave(index)}\n        >\n          <p v-show={!editing.value(index)}>{row.id}</p>\n          <Transition enter-active-class=\"animate__animated animate__fadeInUp animate__faster\">\n            <el-input\n              v-show={editing.value(index)}\n              modelValue={comVal.value(index)}\n              onInput={value => onChange(value, index)}\n            />\n          </Transition>\n          <iconify-icon-offline\n            v-show={editing.value(index)}\n            icon={Check}\n            class={iconClass.value(index)}\n            onClick={() => onSure(index)}\n          />\n          <iconify-icon-offline\n            v-show={activeIndex.value === index && !editing.value(index)}\n            icon={EditPen}\n            class={iconClass.value(index, true)}\n            onClick={() => onEdit(row, index)}\n          />\n        </div>\n      )\n    },\n    {\n      label: \"日期\",\n      prop: \"date\"\n    },\n    {\n      label: \"姓名\",\n      prop: \"name\"\n    },\n    {\n      label: \"地址\",\n      prop: \"address\"\n    }\n  ];\n\n  function onEdit({ id }, index) {\n    inputValMap.value[index] = Object.assign({}, inputValMap.value[index], {\n      value: id\n    });\n    // 处于编辑状态\n    editStatus.value[index] = Object.assign({}, editStatus.value[index], {\n      editing: true\n    });\n  }\n\n  function onMouseleave(index) {\n    inputValMap.value[index]?.value\n      ? (activeIndex.value = index)\n      : (activeIndex.value = -1);\n  }\n\n  function onChange(value, index) {\n    inputValMap.value[index].value = value;\n  }\n\n  function onSure(index) {\n    dataList.value[index].id = inputValMap.value[index].value;\n    message(\n      `您编辑了第 ${index + 1} 行，编辑后数据为：${JSON.stringify(\n        dataList.value[index]\n      )}`,\n      {\n        type: \"success\"\n      }\n    );\n    // 编辑状态关闭\n    editStatus.value[index] = Object.assign({}, editStatus.value[index], {\n      editing: false\n    });\n    delay().then(() => (inputValMap.value[index].value = null));\n  }\n\n  return {\n    columns,\n    dataList\n  };\n}\n"],"names":["useColumns","inputValMap","ref","editStatus","activeIndex","dataList","clone","tableDataEdit","comVal","computed","index","value","editing","iconClass","other","columns","label","prop","cellRenderer","row","_createVNode","onMouseenter","onMouseleave","_withDirectives","id","_vShow","Transition","default","_resolveComponent","onChange","Check","onClick","onSure","EditPen","onEdit","Object","assign","message","JSON","stringify","type","delay","then"],"mappings":"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"}