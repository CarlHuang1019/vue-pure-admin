{"version":3,"file":"index28.js","sources":["../../../src/views/list/card/index.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport Card from \"./components/Card.vue\";\nimport { getCardList } from \"@/api/list\";\nimport { message } from \"@/utils/message\";\nimport { ElMessageBox } from \"element-plus\";\nimport { ref, onMounted, nextTick } from \"vue\";\nimport dialogForm from \"./components/DialogForm.vue\";\nimport { useRenderIcon } from \"@/components/ReIcon/src/hooks\";\nimport Search from \"@iconify-icons/ep/search\";\nimport AddFill from \"@iconify-icons/ri/add-circle-line\";\n\ndefineOptions({\n  name: \"ListCard\"\n});\n\nconst svg = `\n        <path class=\"path\" d=\"\n          M 30 15\n          L 28 17\n          M 25.61 25.61\n          A 15 15, 0, 0, 1, 15 30\n          A 15 15, 0, 1, 1, 27.99 7.5\n          L 15 15\n        \" style=\"stroke-width: 4px; fill: rgba(0, 0, 0, 0)\"/>\n      `;\n\nconst INITIAL_DATA = {\n  name: \"\",\n  status: \"\",\n  description: \"\",\n  type: \"\",\n  mark: \"\"\n};\n\nconst pagination = ref({ current: 1, pageSize: 12, total: 0 });\n\nconst productList = ref([]);\nconst dataLoading = ref(true);\n\nconst getCardListData = async () => {\n  try {\n    const { data } = await getCardList();\n    productList.value = data.list;\n    pagination.value = {\n      ...pagination.value,\n      total: data.list.length\n    };\n  } catch (e) {\n    console.log(e);\n  } finally {\n    setTimeout(() => {\n      dataLoading.value = false;\n    }, 500);\n  }\n};\n\nonMounted(() => {\n  getCardListData();\n});\n\nconst formDialogVisible = ref(false);\nconst formData = ref({ ...INITIAL_DATA });\nconst searchValue = ref(\"\");\n\nconst onPageSizeChange = (size: number) => {\n  pagination.value.pageSize = size;\n  pagination.value.current = 1;\n};\nconst onCurrentChange = (current: number) => {\n  pagination.value.current = current;\n};\nconst handleDeleteItem = product => {\n  ElMessageBox.confirm(\n    product\n      ? `确认删除后${product.name}的所有产品信息将被清空, 且无法恢复`\n      : \"\",\n    \"提示\",\n    {\n      type: \"warning\"\n    }\n  )\n    .then(() => {\n      message(\"删除成功\", { type: \"success\" });\n    })\n    .catch(() => {});\n};\nconst handleManageProduct = product => {\n  formDialogVisible.value = true;\n  nextTick(() => {\n    formData.value = { ...product, status: product?.isSetup ? \"1\" : \"0\" };\n  });\n};\n</script>\n\n<template>\n  <div class=\"main\">\n    <div class=\"w-full flex justify-between mb-4\">\n      <el-button\n        :icon=\"useRenderIcon(AddFill)\"\n        @click=\"formDialogVisible = true\"\n      >\n        新建产品\n      </el-button>\n      <el-input\n        style=\"width: 300px\"\n        v-model=\"searchValue\"\n        placeholder=\"请输入产品名称\"\n        clearable\n      >\n        <template #suffix>\n          <el-icon class=\"el-input__icon\">\n            <IconifyIconOffline\n              v-show=\"searchValue.length === 0\"\n              :icon=\"Search\"\n            />\n          </el-icon>\n        </template>\n      </el-input>\n    </div>\n    <div\n      v-loading=\"dataLoading\"\n      :element-loading-svg=\"svg\"\n      element-loading-svg-view-box=\"-10, -10, 50, 50\"\n    >\n      <el-empty\n        description=\"暂无数据\"\n        v-show=\"\n          productList\n            .slice(\n              pagination.pageSize * (pagination.current - 1),\n              pagination.pageSize * pagination.current\n            )\n            .filter(v =>\n              v.name.toLowerCase().includes(searchValue.toLowerCase())\n            ).length === 0\n        \"\n      />\n      <template v-if=\"pagination.total > 0\">\n        <el-row :gutter=\"16\">\n          <el-col\n            v-for=\"(product, index) in productList\n              .slice(\n                pagination.pageSize * (pagination.current - 1),\n                pagination.pageSize * pagination.current\n              )\n              .filter(v =>\n                v.name.toLowerCase().includes(searchValue.toLowerCase())\n              )\"\n            :key=\"index\"\n            :xs=\"24\"\n            :sm=\"12\"\n            :md=\"8\"\n            :lg=\"6\"\n            :xl=\"4\"\n          >\n            <Card\n              :product=\"product\"\n              @delete-item=\"handleDeleteItem\"\n              @manage-product=\"handleManageProduct\"\n            />\n          </el-col>\n        </el-row>\n        <el-pagination\n          class=\"float-right\"\n          v-model:currentPage=\"pagination.current\"\n          :page-size=\"pagination.pageSize\"\n          :total=\"pagination.total\"\n          :page-sizes=\"[12, 24, 36]\"\n          :background=\"true\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          @size-change=\"onPageSizeChange\"\n          @current-change=\"onCurrentChange\"\n        />\n      </template>\n    </div>\n    <dialogForm v-model:visible=\"formDialogVisible\" :data=\"formData\" />\n  </div>\n</template>\n"],"names":["svg","INITIAL_DATA","pagination","ref","productList","dataLoading","getCardListData","data","getCardList","onMounted","formDialogVisible","formData","searchValue","onPageSizeChange","size","onCurrentChange","current","handleDeleteItem","product","ElMessageBox","message","handleManageProduct","nextTick","_ctx","_cache","_component_el_button","_resolveComponent"],"mappings":"ifAeMA,GAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uDAWZ,MAAMC,EAAe,CACnB,KAAM,GACN,OAAQ,GACR,YAAa,GACb,KAAM,GACN,KAAM,EAAA,EAGFC,EAAaC,EAAI,CAAE,QAAS,EAAG,SAAU,GAAI,MAAO,CAAA,CAAG,EAEvDC,EAAcD,EAAI,CAAA,CAAE,EACpBE,EAAcF,EAAI,EAAI,EAEtBG,EAAkB,SAAY,CAC9B,GAAA,CACF,KAAM,CAAE,KAAAC,CAAA,EAAS,MAAMC,IACvBJ,EAAY,MAAQG,EAAK,KACzBL,EAAW,MAAQ,CACjB,GAAGA,EAAW,MACd,MAAOK,EAAK,KAAK,MAAA,CACnB,MACU,SAAA,CACV,eAAa,CACbF,EAAA,MAAA,EACA,EAAA,GAAA,CACE,CAAoB,EAExBI,EAAA,IAAA,CACFH,GAEA,CAAA,EACkB,MAAAI,EAAAP,EAAA,EAAA,EACjBQ,EAAAR,EAAA,CAAA,GAAAF,CAAA,CAAA,EAEKW,EAAAT,EAAA,EAAoB,EACpBU,EAAoBC,IACpBZ,EAAA,MAAA,SAAoBY,EAEpBZ,EAAA,MAAA,QAAqC,CACzC,EACAa,EAA2BC,GAAA,CAC7Bd,EAAA,MAAA,QAAAc,CACA,EACEC,EAA2BC,GAAA,CAC7BC,EAAA,QACAD,YAAoC,IAAA,qBAAA,GACrB,KACX,CAGA,KAAA,SACA,CAAA,EAAA,KACQ,IAAA,CACRE,EAAA,OAAA,CAAA,KAAA,SAAA,CAAA,CAAA,CACF,QACc,IAAA,CACV,CAAA,CAAmC,EAEtBC,EAAAH,GAAA,CACnBR,EAAA,MAAA,GACAY,OACEX,EAAA,MAA0B,CAAA,GAAAO,EAAA,OAAAA,GAAA,MAAAA,EAAA,QAAA,IAAA,IAC1B,CAAA,CACE,EAAoE,MACrE,CAAAK,EAAAC,IAAA,CACH,MAAAC,EAAAC,EAAA,WAAA"}