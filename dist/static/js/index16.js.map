{"version":3,"file":"index16.js","sources":["../../../src/components/ReCountTo/src/normal/props.ts","../../../src/components/ReCountTo/src/normal/index.tsx","../../../src/components/ReCountTo/src/rebound/props.ts","../../../src/components/ReCountTo/src/rebound/index.tsx","../../../src/components/ReCountTo/index.ts"],"sourcesContent":["import { PropType } from \"vue\";\nimport propTypes from \"@/utils/propTypes\";\nexport const countToProps = {\n  startVal: propTypes.number.def(0),\n  endVal: propTypes.number.def(2020),\n  duration: propTypes.number.def(1300),\n  autoplay: propTypes.bool.def(true),\n  decimals: {\n    type: Number as PropType<number>,\n    required: false,\n    default: 0,\n    validator(value: number) {\n      return value >= 0;\n    }\n  },\n  color: propTypes.string.def(),\n  fontSize: propTypes.string.def(),\n  decimal: propTypes.string.def(\".\"),\n  separator: propTypes.string.def(\",\"),\n  prefix: propTypes.string.def(\"\"),\n  suffix: propTypes.string.def(\"\"),\n  useEasing: propTypes.bool.def(true),\n  easingFn: {\n    type: Function as PropType<\n      (t: number, b: number, c: number, d: number) => number\n    >,\n    default(t: number, b: number, c: number, d: number) {\n      return (c * (-Math.pow(2, (-10 * t) / d) + 1) * 1024) / 1023 + b;\n    }\n  }\n};\n","import {\n  defineComponent,\n  reactive,\n  computed,\n  watch,\n  onMounted,\n  unref\n} from \"vue\";\nimport { countToProps } from \"./props\";\nimport { isNumber } from \"@pureadmin/utils\";\n\nexport default defineComponent({\n  name: \"ReNormalCountTo\",\n  props: countToProps,\n  emits: [\"mounted\", \"callback\"],\n  setup(props, { emit }) {\n    const state = reactive<{\n      localStartVal: number;\n      printVal: number | null;\n      displayValue: string;\n      paused: boolean;\n      localDuration: number | null;\n      startTime: number | null;\n      timestamp: number | null;\n      rAF: any;\n      remaining: number | null;\n      color: string;\n      fontSize: string;\n    }>({\n      localStartVal: props.startVal,\n      displayValue: formatNumber(props.startVal),\n      printVal: null,\n      paused: false,\n      localDuration: props.duration,\n      startTime: null,\n      timestamp: null,\n      remaining: null,\n      rAF: null,\n      color: null,\n      fontSize: \"16px\"\n    });\n\n    const getCountDown = computed(() => {\n      return props.startVal > props.endVal;\n    });\n\n    watch([() => props.startVal, () => props.endVal], () => {\n      if (props.autoplay) {\n        start();\n      }\n    });\n\n    function start() {\n      const { startVal, duration, color, fontSize } = props;\n      state.localStartVal = startVal;\n      state.startTime = null;\n      state.localDuration = duration;\n      state.paused = false;\n      state.color = color;\n      state.fontSize = fontSize;\n      state.rAF = requestAnimationFrame(count);\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars,no-unused-vars\n    function pauseResume() {\n      if (state.paused) {\n        resume();\n        state.paused = false;\n      } else {\n        pause();\n        state.paused = true;\n      }\n    }\n\n    function pause() {\n      cancelAnimationFrame(state.rAF);\n    }\n\n    function resume() {\n      state.startTime = null;\n      state.localDuration = +(state.remaining as number);\n      state.localStartVal = +(state.printVal as number);\n      requestAnimationFrame(count);\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars,no-unused-vars\n    function reset() {\n      state.startTime = null;\n      cancelAnimationFrame(state.rAF);\n      state.displayValue = formatNumber(props.startVal);\n    }\n\n    function count(timestamp: number) {\n      const { useEasing, easingFn, endVal } = props;\n      if (!state.startTime) state.startTime = timestamp;\n      state.timestamp = timestamp;\n      const progress = timestamp - state.startTime;\n      state.remaining = (state.localDuration as number) - progress;\n      if (useEasing) {\n        if (unref(getCountDown)) {\n          state.printVal =\n            state.localStartVal -\n            easingFn(\n              progress,\n              0,\n              state.localStartVal - endVal,\n              state.localDuration as number\n            );\n        } else {\n          state.printVal = easingFn(\n            progress,\n            state.localStartVal,\n            endVal - state.localStartVal,\n            state.localDuration as number\n          );\n        }\n      } else {\n        if (unref(getCountDown)) {\n          state.printVal =\n            state.localStartVal -\n            (state.localStartVal - endVal) *\n              (progress / (state.localDuration as number));\n        } else {\n          state.printVal =\n            state.localStartVal +\n            (endVal - state.localStartVal) *\n              (progress / (state.localDuration as number));\n        }\n      }\n      if (unref(getCountDown)) {\n        state.printVal = state.printVal < endVal ? endVal : state.printVal;\n      } else {\n        state.printVal = state.printVal > endVal ? endVal : state.printVal;\n      }\n      state.displayValue = formatNumber(state.printVal);\n      if (progress < (state.localDuration as number)) {\n        state.rAF = requestAnimationFrame(count);\n      } else {\n        emit(\"callback\");\n      }\n    }\n\n    function formatNumber(num: number | string) {\n      const { decimals, decimal, separator, suffix, prefix } = props;\n      num = Number(num).toFixed(decimals);\n      num += \"\";\n      const x = num.split(\".\");\n      let x1 = x[0];\n      const x2 = x.length > 1 ? decimal + x[1] : \"\";\n      const rgx = /(\\d+)(\\d{3})/;\n      if (separator && !isNumber(separator)) {\n        while (rgx.test(x1)) {\n          x1 = x1.replace(rgx, \"$1\" + separator + \"$2\");\n        }\n      }\n      return prefix + x1 + x2 + suffix;\n    }\n\n    onMounted(() => {\n      if (props.autoplay) {\n        start();\n      }\n      emit(\"mounted\");\n    });\n\n    return () => (\n      <>\n        <span\n          style={{\n            color: props.color,\n            fontSize: props.fontSize\n          }}\n        >\n          {state.displayValue}\n        </span>\n      </>\n    );\n  }\n});\n","import { PropType } from \"vue\";\nimport propTypes from \"@/utils/propTypes\";\nexport const reboundProps = {\n  delay: propTypes.number.def(1),\n  blur: propTypes.number.def(2),\n  i: {\n    type: Number as PropType<number>,\n    required: false,\n    default: 0,\n    validator(value: number) {\n      return value < 10 && value >= 0 && Number.isInteger(value);\n    }\n  }\n};\n","import \"./rebound.css\";\nimport {\n  defineComponent,\n  ref,\n  unref,\n  onBeforeMount,\n  onBeforeUnmount\n} from \"vue\";\nimport { reboundProps } from \"./props\";\n\nexport default defineComponent({\n  name: \"ReboundCountTo\",\n  props: reboundProps,\n  setup(props) {\n    const ulRef = ref();\n    const timer = ref(null);\n\n    onBeforeMount(() => {\n      const ua = navigator.userAgent.toLowerCase();\n      const testUA = regexp => regexp.test(ua);\n      const isSafari = testUA(/safari/g) && !testUA(/chrome/g);\n\n      // Safari浏览器的兼容代码\n      isSafari &&\n        (timer.value = setTimeout(() => {\n          ulRef.value.setAttribute(\n            \"style\",\n            `\n        animation: none;\n        transform: translateY(calc(var(--i) * -9.09%))\n      `\n          );\n        }, props.delay * 1000));\n    });\n\n    onBeforeUnmount(() => {\n      clearTimeout(unref(timer));\n    });\n\n    return () => (\n      <>\n        <div\n          class=\"scroll-num\"\n          style={{ \"--i\": props.i, \"--delay\": props.delay }}\n        >\n          <ul ref=\"ulRef\" style={{ fontSize: \"32px\" }}>\n            <li>0</li>\n            <li>1</li>\n            <li>2</li>\n            <li>3</li>\n            <li>4</li>\n            <li>5</li>\n            <li>6</li>\n            <li>7</li>\n            <li>8</li>\n            <li>9</li>\n            <li>0</li>\n          </ul>\n\n          <svg width=\"0\" height=\"0\">\n            <filter id=\"blur\">\n              <feGaussianBlur\n                in=\"SourceGraphic\"\n                stdDeviation={`0 ${props.blur}`}\n              />\n            </filter>\n          </svg>\n        </div>\n      </>\n    );\n  }\n});\n","import reNormalCountTo from \"./src/normal\";\nimport reboundCountTo from \"./src/rebound\";\nimport { withInstall } from \"@pureadmin/utils\";\n\n/** 普通数字动画组件 */\nconst ReNormalCountTo = withInstall(reNormalCountTo);\n\n/** 回弹式数字动画组件 */\nconst ReboundCountTo = withInstall(reboundCountTo);\n\nexport { ReNormalCountTo, ReboundCountTo };\n"],"names":["countToProps","propTypes","value","b","c","d","defineComponent","name","props","emits","setup","emit","state","reactive","localStartVal","startVal","displayValue","formatNumber","printVal","paused","localDuration","duration","startTime","timestamp","remaining","rAF","color","fontSize","getCountDown","computed","endVal","watch","autoplay","start","requestAnimationFrame","count","useEasing","easingFn","progress","unref","num","decimals","decimal","separator","suffix","prefix","Number","toFixed","x","split","x1","x2","length","rgx","isNumber","test","replace","onMounted","_createVNode","_Fragment","reboundProps","ulRef","ref","timer","onBeforeMount","ua","navigator","userAgent","toLowerCase","testUA","regexp","setTimeout","setAttribute","delay","onBeforeUnmount","clearTimeout","i","_createTextVNode","blur","ReNormalCountTo","withInstall","reNormalCountTo","ReboundCountTo","reboundCountTo"],"mappings":"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"}