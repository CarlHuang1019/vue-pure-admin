var E=Object.defineProperty,B=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var b=(a,e,t)=>e in a?E(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,y=(a,e)=>{for(var t in e||(e={}))V.call(e,t)&&b(a,t,e[t]);if(x)for(var t of x(e))z.call(e,t)&&b(a,t,e[t]);return a},w=(a,e)=>B(a,S(e));import{u as f,w as K}from"./xlsx-xf2utV5S.js";import{d as N,f as j,j as u,k as i,e as A,g as $,l as d,m as p,u as g}from"./index-Bp-Azfsb.js";const F={class:"font-medium"},J={class:"h-[25rem] mt-3"},q=N({name:"Excel",__name:"excel",setup(a){const e=(s=10,n="column-",r)=>Array.from({length:s}).map((c,o)=>w(y({},r),{key:`${n}${o}`,dataKey:`${n}${o}`,title:`Column ${o}`,width:150})),t=(s,n=200,r="row-")=>Array.from({length:n}).map((c,o)=>s.reduce((l,_,h)=>(l[_.dataKey]=`Row ${o} - Col ${h}`,l),{id:`${r}${o}`,parentId:null})),m=e(10),k=t(m,1e3),C=()=>{const s=k.map(o=>{const l=[];return m.forEach(_=>{l.push(o[_.dataKey])}),l}),n=[];m.forEach(o=>{n.push(o.title)}),s.unshift(n);const r=f.aoa_to_sheet(s),c=f.book_new();f.book_append_sheet(c,r,"数据报表"),K(c,"tableV2.xlsx")};return(s,n)=>{const r=i("el-link"),c=i("el-button"),o=i("el-table-v2"),l=i("el-auto-resizer"),_=i("el-card");return A(),j(_,{shadow:"never"},{header:u(()=>[$("div",F,[d(" 导出Excel（ "),p(r,{href:"https://github.com/SheetJS/sheetjs",target:"_blank",style:{margin:"0 5px 4px 0","font-size":"16px"}},{default:u(()=>[d(" github地址 ")]),_:1}),d(" ） ")])]),default:u(()=>[p(c,{type:"primary",onClick:C},{default:u(()=>[d("导出Excel")]),_:1}),$("div",J,[p(l,null,{default:u(({height:h,width:v})=>[p(o,{columns:g(m),data:g(k),width:v,height:h,fixed:""},null,8,["columns","data","width","height"])]),_:1})])]),_:1})}}});export{q as default};
