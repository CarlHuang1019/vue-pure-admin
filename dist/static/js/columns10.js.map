{"version":3,"file":"columns10.js","sources":["../../../src/views/pure-table/high/excel/columns.tsx"],"sourcesContent":["import { ref } from \"vue\";\nimport { utils, writeFile } from \"xlsx\";\nimport { tableDataDrag } from \"../data\";\nimport { clone } from \"@pureadmin/utils\";\nimport { message } from \"@/utils/message\";\n\nexport function useColumns() {\n  const dataList = ref(clone(tableDataDrag, true));\n\n  const columns: TableColumnList = [\n    {\n      label: \"ID\",\n      prop: \"id\"\n    },\n    {\n      label: \"日期\",\n      prop: \"date\"\n    },\n    {\n      label: \"姓名\",\n      prop: \"name\"\n    }\n  ];\n\n  const exportExcel = () => {\n    const res = dataList.value.map(item => {\n      const arr = [];\n      columns.forEach(column => {\n        arr.push(item[column.prop as string]);\n      });\n      return arr;\n    });\n    const titleList = [];\n    columns.forEach(column => {\n      titleList.push(column.label);\n    });\n    res.unshift(titleList);\n    const workSheet = utils.aoa_to_sheet(res);\n    const workBook = utils.book_new();\n    utils.book_append_sheet(workBook, workSheet, \"数据报表\");\n    writeFile(workBook, \"pure-admin-table.xlsx\");\n    message(\"导出成功\", {\n      type: \"success\"\n    });\n  };\n\n  return {\n    columns,\n    dataList,\n    exportExcel\n  };\n}\n"],"names":["useColumns","dataList","ref","clone","tableDataDrag","columns","label","prop","exportExcel","res","value","map","item","arr","forEach","column","push","titleList","unshift","workSheet","utils","aoa_to_sheet","workBook","book_new","book_append_sheet","writeFile","message","type"],"mappings":"iHAMO,SAASA,GAAa,CAC3B,MAAMC,EAAWC,EAAIC,EAAMC,EAAe,EAAI,CAAC,EAEzCC,EAA2B,CAC/B,CACEC,MAAO,KACPC,KAAM,IACR,EACA,CACED,MAAO,KACPC,KAAM,MACR,EACA,CACED,MAAO,KACPC,KAAM,MACR,CAAC,EAyBH,MAAO,CACLF,QAAAA,EACAJ,SAAAA,EACAO,YAzBkBA,IAAM,CACxB,MAAMC,EAAMR,EAASS,MAAMC,IAAIC,GAAQ,CACrC,MAAMC,EAAM,CAAA,EACZR,OAAAA,EAAQS,QAAQC,GAAU,CACxBF,EAAIG,KAAKJ,EAAKG,EAAOR,IAAI,CAAW,CACtC,CAAC,EACMM,CACT,CAAC,EACKI,EAAY,CAAA,EAClBZ,EAAQS,QAAQC,GAAU,CACxBE,EAAUD,KAAKD,EAAOT,KAAK,CAC7B,CAAC,EACDG,EAAIS,QAAQD,CAAS,EACrB,MAAME,EAAYC,EAAMC,aAAaZ,CAAG,EAClCa,EAAWF,EAAMG,WACvBH,EAAMI,kBAAkBF,EAAUH,EAAW,MAAM,EACnDM,EAAUH,EAAU,uBAAuB,EAC3CI,EAAQ,OAAQ,CACdC,KAAM,SACR,CAAC,GAQL"}